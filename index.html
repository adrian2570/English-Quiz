<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Auto English Quiz</title>
  <style>
    /* Mobile-first design */
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 15px;
      background: #f0f2f5;
    }
    
    .container {
      max-width: 600px;
      margin: 0 auto;
    }

    h2 {
      color: #1a73e8;
      font-size: 1.8rem;
      text-align: center;
      margin: 20px 0;
    }

    input, button, select {
      width: 100%;
      padding: 12px;
      margin: 8px 0;
      border: 2px solid #ddd;
      border-radius: 8px;
      font-size: 1.1rem;
      box-sizing: border-box;
    }

    button {
      background: #1a73e8;
      color: white;
      border: none;
      font-weight: bold;
      touch-action: manipulation;
    }

    #sentence {
      font-size: 1.4rem;
      line-height: 1.5;
      margin: 25px 0;
      padding: 15px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    #message {
      font-size: 1.2rem;
      padding: 10px;
      border-radius: 8px;
      margin: 15px 0;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>🇺🇸 Auto English Quiz</h2>
    <p id="sentence"></p>
    <input type="text" id="answer" placeholder="Type missing word..." autocapitalize="none">
    <p id="message"></p>
  </div>

<script>
// Quiz Data and State
let sentences = [
  {
    sentence: "The ____ is shining brightly today.",
    fullSentence: "The sun is shining brightly today.",
    hiddenWord: "sun"
  },
  {
    sentence: "She ____ to the store yesterday.",
    fullSentence: "She went to the store yesterday.",
    hiddenWord: "went"
  }
];
let currentIndex = 0;
let score = 0;
let selectedVoice = null;

// Auto-configure US female voice
function setUSFemaleVoice() {
  const voices = window.speechSynthesis.getVoices();
  // Try to find a US English female voice
  const usFemale = voices.find(v => 
    v.lang === 'en-US' && v.name.toLowerCase().includes('female')
  );
  selectedVoice = usFemale || voices.find(v => v.lang === 'en-US') || voices[0];
}

// Automatic quiz flow
function startQuiz() {
  currentIndex = 0;
  score = 0;
  setUSFemaleVoice();
  loadQuestion();
}

function loadQuestion() {
  if (currentIndex >= sentences.length) return showResults();
  
  const current = sentences[currentIndex];
  document.getElementById('sentence').textContent = current.sentence;
  document.getElementById('answer').value = '';
  document.getElementById('message').textContent = '';
  
  // Auto-read question with delay
  setTimeout(() => {
    speakText(current.fullSentence);
    document.getElementById('answer').focus();
  }, 500);
}

function checkAnswer() {
  const userAnswer = document.getElementById('answer').value.trim().toLowerCase();
  const correctAnswer = sentences[currentIndex].hiddenWord.toLowerCase();

  if (!userAnswer) {
    showMessage("📝 Please type an answer!", '#ff4444');
    return;
  }

  if (userAnswer === correctAnswer) {
    score++;
    showMessage(`✅ Correct!`, '#00c851');
    currentIndex++;
    // Auto-proceed after 1.5 seconds
    setTimeout(loadQuestion, 1500);
  } else {
    showMessage(`❌ Try again!`, '#ff4444');
    // Auto-replay question after 2 seconds
    setTimeout(() => speakText(sentences[currentIndex].fullSentence), 2000);
  }
}

function showMessage(text, color) {
  const msg = document.getElementById('message');
  msg.textContent = text;
  msg.style.background = color + '20';
  msg.style.color = color;
}

function speakText(text) {
  if (!window.speechSynthesis) return;
  const utterance = new SpeechSynthesisUtterance(text);
  utterance.voice = selectedVoice;
  utterance.rate = 1.0;
  utterance.pitch = 1.1;
  window.speechSynthesis.cancel();
  window.speechSynthesis.speak(utterance);
}

function showResults() {
  document.getElementById('sentence').textContent = `Quiz Complete! Score: ${score}/${sentences.length}`;
  speakText(`Quiz finished. You got ${score} out of ${sentences.length} correct.`);
  document.getElementById('answer').style.display = 'none';
}

// Initialize quiz
window.onload = () => {
  speechSynthesis.onvoiceschanged = () => {
    setUSFemaleVoice();
    startQuiz();
  };
  
  // Handle Enter key
  document.addEventListener('keypress', e => {
    if (e.key === 'Enter') checkAnswer();
  });
};
</script>
</body>
</html>
